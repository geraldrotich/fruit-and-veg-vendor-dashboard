<!DOCTYPE html>
<html>
<head>
  <title>Standing Orders Dashboard</title>
  <meta charset="UTF-8" />
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
    }
    h2 {
      margin-bottom: 10px;
    }
    .vendor-card {
      border: 1px solid #ccc;
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 8px;
    }
    .vendor-header {
      font-weight: bold;
      font-size: 1.2em;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }
    th, td {
      padding: 8px;
      border: 1px solid #ccc;
    }
    th {
      background: #f0f0f0;
    }
    .add-btn, .action-btn {
      margin-top: 10px;
      padding: 8px 12px;
      font-size: 0.95em;
      cursor: pointer;
      border: none;
      border-radius: 6px;
      background-color: #007bff;
      color: white;
    }
    .popup {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: white;
      border: 2px solid #ccc;
      padding: 20px;
      z-index: 1000;
      display: none;
      width: 300px;
      border-radius: 10px;
    }
    .popup input {
      width: 100%;
      padding: 6px;
      margin-bottom: 10px;
    }
    .popup h3 {
      margin-top: 0;
    }
    .overlay {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.3);
      z-index: 999;
    }
    .action-icon {
      width: 38px;
      height: 38px;
      font-size: 18px;
      display: flex;
      align-items: center;
      justify-content: center;
      background-color: #eee;
      border: 1px solid #aaa;
      border-radius: 6px;
      cursor: pointer;
    }
    .action-icon:hover {
      background-color: #ddd;
    }
  </style>
</head>
<body>
  <h2>Standing Orders</h2>
  <button class="add-btn" onclick="openVendorPopup()">+ Add New Vendor</button>

  <div id="vendorsContainer"></div>

  <!-- Vendor Popup -->
  <div class="overlay" id="overlay"></div>
  <div class="popup" id="vendorPopup">
    <h3>Add New Vendor</h3>
    <input type="text" id="vendorName" placeholder="Vendor Name" />
    <input type="text" id="vendorContact" placeholder="Contact" />
    <button onclick="saveVendor()">Save Vendor</button>
    <button onclick="closeVendorPopup()">Cancel</button>
  </div>

  <script>
    let vendors = JSON.parse(localStorage.getItem('standingOrders')) || [];

    function saveVendorsToStorage() {
      localStorage.setItem('standingOrders', JSON.stringify(vendors));
    }

    function openVendorPopup() {
      document.getElementById('overlay').style.display = 'block';
      document.getElementById('vendorPopup').style.display = 'block';
    }

    function closeVendorPopup() {
      document.getElementById('overlay').style.display = 'none';
      document.getElementById('vendorPopup').style.display = 'none';
      document.getElementById('vendorName').value = '';
      document.getElementById('vendorContact').value = '';
    }

    function saveVendor() {
      const name = document.getElementById('vendorName').value.trim();
      const contact = document.getElementById('vendorContact').value.trim();
      if (!name || !contact) return alert('Please fill in all fields.');

      vendors.push({ name, contact, products: [] });
      saveVendorsToStorage();
      renderVendors();
      closeVendorPopup();
    }

    function renderVendors() {
      const container = document.getElementById('vendorsContainer');
      container.innerHTML = '';
      vendors.forEach((vendor, vendorIndex) => {
        const div = document.createElement('div');
        div.className = 'vendor-card';
        div.innerHTML = `
          <div class="vendor-header">${vendor.name} - ${vendor.contact}</div>
          <table>
            <thead>
              <tr><th>Product</th><th>Quantity</th><th>Order Day</th><th>Delivery Day</th><th>Actions</th></tr>
            </thead>
            <tbody>
              ${vendor.products.map((p, i) => `
                <tr>
                  <td>${p.product}</td>
                  <td>${p.quantity}</td>
                  <td>${p.orderDay}</td>
                  <td>${p.deliveryDay}</td>
                  <td>
                    <button class="action-icon" onclick="editProduct(${vendorIndex}, ${i})">‚úèÔ∏è</button>
                    <button class="action-icon" onclick="deleteProduct(${vendorIndex}, ${i})">üóëÔ∏è</button>
                  </td>
                </tr>`).join('')}
            </tbody>
          </table>
          <div>
            <input placeholder="Product" id="prod-${vendorIndex}" />
            <input placeholder="Qty" id="qty-${vendorIndex}" style="width:60px;" />
            <input placeholder="Order Day" id="od-${vendorIndex}" style="width:90px;" />
            <input placeholder="Delivery Day" id="dd-${vendorIndex}" style="width:100px;" />
            <button class="add-btn" onclick="addProduct(${vendorIndex})">+ Add Product</button>
          </div>
        `;
        container.appendChild(div);
      });
    }

    function addProduct(index) {
      const product = document.getElementById(`prod-${index}`).value.trim();
      const quantity = document.getElementById(`qty-${index}`).value.trim();
      const orderDay = document.getElementById(`od-${index}`).value.trim();
      const deliveryDay = document.getElementById(`dd-${index}`).value.trim();
      if (!product || !quantity || !orderDay || !deliveryDay) return alert("Fill all product fields.");
      vendors[index].products.push({ product, quantity, orderDay, deliveryDay });
      saveVendorsToStorage();
      renderVendors();
    }

    function deleteProduct(vendorIndex, productIndex) {
      if (!confirm("Delete this product?")) return;
      vendors[vendorIndex].products.splice(productIndex, 1);
      saveVendorsToStorage();
      renderVendors();
    }

    function editProduct(vendorIndex, productIndex) {
      const p = vendors[vendorIndex].products[productIndex];
      const newProduct = prompt("Product name:", p.product);
      if (newProduct === null) return;
      const newQty = prompt("Quantity:", p.quantity);
      if (newQty === null) return;
      const newOD = prompt("Order Day:", p.orderDay);
      if (newOD === null) return;
      const newDD = prompt("Delivery Day:", p.deliveryDay);
      if (newDD === null) return;
      vendors[vendorIndex].products[productIndex] = {
        product: newProduct.trim(),
        quantity: newQty.trim(),
        orderDay: newOD.trim(),
        deliveryDay: newDD.trim()
      };
      saveVendorsToStorage();
      renderVendors();
    }

    renderVendors();
  </script>
</body>
</html>
